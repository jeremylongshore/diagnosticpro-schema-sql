{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://diagnosticpro.com/schemas/parts_inventory.json",
  "title": "Parts Inventory",
  "description": "Parts catalog and inventory management schema",
  "type": "object",
  "required": [
    "part_id",
    "part_number",
    "created_at",
    "updated_at"
  ],
  "properties": {
    "part_id": {
      "type": "string",
      "pattern": "^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$",
      "description": "UUID v4 part identifier"
    },
    "part_number": {
      "type": "string",
      "pattern": "^[A-Z0-9-]+$",
      "maxLength": 50,
      "minLength": 1,
      "description": "Unique alphanumeric part number with dashes"
    },
    "part_name": {
      "type": ["string", "null"],
      "maxLength": 200,
      "description": "Human-readable part name"
    },
    "description": {
      "type": ["string", "null"],
      "maxLength": 2000,
      "description": "Detailed part description"
    },
    "category": {
      "type": ["string", "null"],
      "enum": [
        "engine",
        "transmission",
        "brakes",
        "suspension",
        "electrical",
        "fuel_system",
        "cooling_system",
        "exhaust",
        "body",
        "interior",
        "electronics",
        "filters",
        "fluids",
        "belts_hoses",
        "sensors",
        "actuators",
        "control_modules",
        "hardware",
        "tools",
        "consumables"
      ],
      "description": "Part category classification"
    },
    "subcategory": {
      "type": ["string", "null"],
      "maxLength": 100,
      "description": "More specific part subcategory"
    },
    "manufacturer": {
      "type": ["string", "null"],
      "maxLength": 100,
      "description": "Part manufacturer name"
    },
    "brand": {
      "type": ["string", "null"],
      "maxLength": 100,
      "description": "Part brand name"
    },
    "model": {
      "type": ["string", "null"],
      "maxLength": 100,
      "description": "Part model designation"
    },
    "pricing": {
      "type": "object",
      "properties": {
        "list_price": {
          "type": ["number", "null"],
          "minimum": 0,
          "description": "Manufacturer list price"
        },
        "cost": {
          "type": ["number", "null"],
          "minimum": 0,
          "description": "Wholesale/dealer cost"
        },
        "msrp": {
          "type": ["number", "null"],
          "minimum": 0,
          "description": "Manufacturer suggested retail price"
        },
        "currency": {
          "type": ["string", "null"],
          "pattern": "^[A-Z]{3}$",
          "description": "ISO 4217 currency code"
        },
        "pricing_tier": {
          "type": ["string", "null"],
          "enum": ["economy", "standard", "premium", "oem", "aftermarket"],
          "description": "Pricing tier classification"
        }
      },
      "additionalProperties": false
    },
    "specifications": {
      "type": "object",
      "properties": {
        "weight_lbs": {
          "type": ["number", "null"],
          "minimum": 0,
          "maximum": 10000,
          "description": "Part weight in pounds (max 5 tons)"
        },
        "dimensions_inches": {
          "type": "object",
          "properties": {
            "length": {
              "type": ["number", "null"],
              "minimum": 0
            },
            "width": {
              "type": ["number", "null"],
              "minimum": 0
            },
            "height": {
              "type": ["number", "null"],
              "minimum": 0
            },
            "diameter": {
              "type": ["number", "null"],
              "minimum": 0
            }
          },
          "additionalProperties": false
        },
        "material": {
          "type": ["string", "null"],
          "maxLength": 100,
          "description": "Primary material composition"
        },
        "color": {
          "type": ["string", "null"],
          "maxLength": 50,
          "description": "Part color"
        },
        "warranty_months": {
          "type": ["integer", "null"],
          "minimum": 0,
          "maximum": 360,
          "description": "Warranty period in months (max 30 years)"
        },
        "service_life_miles": {
          "type": ["integer", "null"],
          "minimum": 0,
          "description": "Expected service life in miles"
        },
        "operating_temp_range": {
          "type": "object",
          "properties": {
            "min_fahrenheit": {
              "type": ["number", "null"]
            },
            "max_fahrenheit": {
              "type": ["number", "null"]
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "compatibility": {
      "type": "object",
      "properties": {
        "fits_equipment_ids": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$"
          },
          "description": "Equipment IDs this part fits"
        },
        "vehicle_makes": {
          "type": "array",
          "items": {
            "type": "string",
            "maxLength": 50
          },
          "description": "Compatible vehicle makes"
        },
        "vehicle_models": {
          "type": "array",
          "items": {
            "type": "string",
            "maxLength": 50
          },
          "description": "Compatible vehicle models"
        },
        "model_years": {
          "type": "array",
          "items": {
            "type": "integer",
            "minimum": 1900,
            "maximum": 2030
          },
          "description": "Compatible model years"
        },
        "engine_types": {
          "type": "array",
          "items": {
            "type": "string",
            "maxLength": 100
          },
          "description": "Compatible engine types"
        }
      },
      "additionalProperties": false
    },
    "inventory": {
      "type": "object",
      "properties": {
        "stock_quantity": {
          "type": ["integer", "null"],
          "minimum": 0,
          "description": "Current stock quantity"
        },
        "reserved_quantity": {
          "type": ["integer", "null"],
          "minimum": 0,
          "description": "Quantity reserved for orders"
        },
        "available_quantity": {
          "type": ["integer", "null"],
          "minimum": 0,
          "description": "Available quantity (stock - reserved)"
        },
        "reorder_point": {
          "type": ["integer", "null"],
          "minimum": 0,
          "description": "Reorder point threshold"
        },
        "reorder_quantity": {
          "type": ["integer", "null"],
          "minimum": 1,
          "description": "Standard reorder quantity"
        },
        "location": {
          "type": ["string", "null"],
          "maxLength": 100,
          "description": "Storage location identifier"
        },
        "bin_location": {
          "type": ["string", "null"],
          "maxLength": 50,
          "description": "Specific bin or shelf location"
        }
      },
      "additionalProperties": false
    },
    "supplier": {
      "type": "object",
      "properties": {
        "primary_supplier_id": {
          "type": ["string", "null"],
          "pattern": "^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$",
          "description": "Primary supplier UUID"
        },
        "supplier_part_number": {
          "type": ["string", "null"],
          "maxLength": 100,
          "description": "Supplier's part number"
        },
        "lead_time_days": {
          "type": ["integer", "null"],
          "minimum": 0,
          "maximum": 365,
          "description": "Supplier lead time in days"
        },
        "minimum_order_quantity": {
          "type": ["integer", "null"],
          "minimum": 1,
          "description": "Minimum order quantity from supplier"
        },
        "last_cost": {
          "type": ["number", "null"],
          "minimum": 0,
          "description": "Last purchase cost"
        },
        "last_order_date": {
          "type": ["string", "null"],
          "format": "date",
          "description": "Date of last order"
        }
      },
      "additionalProperties": false
    },
    "availability_status": {
      "type": ["string", "null"],
      "enum": ["in_stock", "low_stock", "out_of_stock", "discontinued", "backordered", "special_order"],
      "description": "Current availability status"
    },
    "is_active": {
      "type": ["boolean", "null"],
      "default": true,
      "description": "Whether part is active in catalog"
    },
    "is_oem": {
      "type": ["boolean", "null"],
      "description": "Whether part is Original Equipment Manufacturer"
    },
    "is_core_part": {
      "type": ["boolean", "null"],
      "description": "Whether part requires core exchange"
    },
    "hazmat": {
      "type": ["boolean", "null"],
      "description": "Whether part is hazardous material"
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "Timestamp when record was created"
    },
    "updated_at": {
      "type": "string",
      "format": "date-time",
      "description": "Timestamp when record was last updated"
    },
    "deleted_at": {
      "type": ["string", "null"],
      "format": "date-time",
      "description": "Timestamp when record was soft deleted (null if active)"
    }
  },
  "additionalProperties": false,
  "allOf": [
    {
      "description": "Currency required when any price is specified",
      "if": {
        "properties": {
          "pricing": {
            "anyOf": [
              {"properties": {"list_price": {"type": "number"}}},
              {"properties": {"cost": {"type": "number"}}},
              {"properties": {"msrp": {"type": "number"}}}
            ]
          }
        }
      },
      "then": {
        "properties": {
          "pricing": {
            "required": ["currency"],
            "properties": {
              "currency": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    {
      "description": "Available quantity should be stock minus reserved",
      "if": {
        "properties": {
          "inventory": {
            "properties": {
              "stock_quantity": {"type": "integer"},
              "reserved_quantity": {"type": "integer"}
            }
          }
        }
      },
      "then": {
        "properties": {
          "inventory": {
            "properties": {
              "available_quantity": {
                "type": "integer"
              }
            }
          }
        }
      }
    },
    {
      "description": "Temperature range validation",
      "if": {
        "properties": {
          "specifications": {
            "properties": {
              "operating_temp_range": {
                "properties": {
                  "min_fahrenheit": {"type": "number"},
                  "max_fahrenheit": {"type": "number"}
                }
              }
            }
          }
        }
      },
      "then": {
        "properties": {
          "specifications": {
            "properties": {
              "operating_temp_range": {
                "properties": {
                  "min_fahrenheit": {
                    "type": "number"
                  },
                  "max_fahrenheit": {
                    "type": "number"
                  }
                }
              }
            }
          }
        }
      }
    }
  ]
}